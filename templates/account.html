<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Account</title>

  <!-- Font: Noto Serif TC -->
  <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@400;700&display=swap" rel="stylesheet"/>

  <!-- Bootstrap 4.5 -->
  <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.3/css/bootstrap.min.css"/>

  <!-- (可選) 你的外部樣式 -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}"/>

  <!-- 共用教學樣式 -->
  <link rel="stylesheet" href="{{ url_for('static', filename='css/tutorial.css') }}">

  <style>
    /* 1) 全域配色 */
    :root{
      --primary:#043b8f;
      --primary-dark:#02347e;
      --primary-light:#6499e9;
      --secondary:#0b1f33;
    }

    /* 2) 版面字型與結構 */
    html,body{height:100%;}
    body{
      display:flex;
      flex-direction:column;
      font-family:'Noto Serif TC',serif;
      line-height:1.6;
      background:transparent;
      margin:0;
    }
    h1,h2,h3,h4,h5,h6{
      font-family:'Noto Serif TC',serif;
      font-weight:700;
    }

    /* 3) 頂層背景動畫 */
    body::before{
      content:"";
      position:fixed;inset:0;
      background:url("https://png.pngtree.com/thumb_back/fh260/background/20231227/pngtree-gentle-blue-background-with-a-soft-textured-finish-image_13898387.png") center/cover no-repeat;
      filter:grayscale(20%) brightness(0.55);
      z-index:-1;
      animation:bgZoom 40s ease-in-out infinite alternate;
    }
    @keyframes bgZoom{from{transform:scale(1);}to{transform:scale(1.15);}}

    /* 4) 主要內容卡片 */
    .card-wrapper{
      background:rgba(255,255,255,.94);
      border-radius:.8rem;
      box-shadow:0 10px 30px rgba(0,0,0,.05);
      padding:2rem 2rem 2.5rem;
      margin-top:3rem;
      margin-bottom:3rem;
    }

    /* 5) 標題與區塊 */
    h1{
      font-size:2rem;
      margin:1.2rem 0 1.8rem;
      text-align:center;
      color:var(--primary);
      letter-spacing:.03rem;
    }
    .section-title{
      font-size:1.25rem;
      color:var(--primary);
      margin-top:1.5rem;
      margin-bottom:.75rem;
    }

    /* 6) 表格樣式 */
    .table{
      background:#fff;
      border-radius:.5rem;
      overflow:hidden;
    }
    .table thead th{
      background:#f4f7fb;
      border-bottom:1px solid #e6ecf3;
      color:#223;
    }
    .table td, .table th{
      vertical-align:middle;
    }

    /* 7) 列表樣式 */
    .stock-list{
      background:#fff;
      border:1px solid #e6edf3;
      border-radius:.5rem;
      padding:1rem 1.25rem;
    }

    /* 8) 按鈕樣式（主題同系）*/
    .btn{
      border-radius:2rem;
      font-weight:600;
    }
    .btn-primary{
      background-color:var(--primary);
      border-color:var(--primary);
      box-shadow:0 4px 8px rgba(0,0,0,.08);
      transition:box-shadow .3s ease, background-color .3s ease, border-color .3s ease;
    }
    .btn-primary:hover{
      background-color:var(--primary-dark);
      border-color:var(--primary-dark);
      box-shadow:0 6px 12px rgba(0,0,0,.12);
    }
    .btn-outline-primary{
      color:var(--primary);
      border-color:var(--primary);
      background-color:transparent;
    }
    .btn-outline-primary:hover{
      background-color:var(--primary);
      color:#fff;
      box-shadow:0 6px 12px rgba(0,0,0,.1);
    }
    

    /* 9) 動作區塊 */
    .actions .btn{
      min-width:180px;
    }

    /* 10) 小字 */
    .text-muted{color:#6c757d !important;}

    /* === 先把行動裝置點擊高亮關掉（避免橘色閃一下） === */
    a.btn, button.btn {
    -webkit-tap-highlight-color: transparent;
    }

    /* === 乾脆把所有 Bootstrap 4 可能用到的 focus/active 狀態一次覆寫 === */
    /* 只針對按鈕類，不波及全站可存取性 */
    .btn,
    .btn:focus,
    .btn.focus,
    .btn:active,
    .btn.active,
    .btn:focus:active,
    .btn:active:focus,
    .btn:focus-visible,
    .btn-primary,
    .btn-primary:focus,
    .btn-primary.focus,
    .btn-primary:active,
    .btn-primary.active,
    .btn-outline-primary,
    .btn-outline-primary:focus,
    .btn-outline-primary.focus,
    .btn-outline-primary:active,
    .btn-outline-primary.active,
    .show > .btn.dropdown-toggle,
    .show > .btn-primary.dropdown-toggle,
    .show > .btn-outline-primary.dropdown-toggle {
    outline: none !important;
    box-shadow: none !important;                 /* 干掉預設橘／藍光暈 */
    border-color: var(--primary) !important;     /* 統一成主色邊框 */
    }

    /* 主按鈕：hover/active/focus 都維持藍系，不出現橘邊 */
    .btn-primary:hover,
    .btn-primary:active,
    .btn-primary.active,
    .btn-primary:focus,
    .btn-primary.focus {
    background-color: var(--primary-dark) !important;
    border-color: var(--primary-dark) !important;
    color: #fff !important;
    }

    /* 外框按鈕：hover/active/focus 反白為實心藍；沒有橘色邊框 */
    .btn-outline-primary:hover,
    .btn-outline-primary:active,
    .btn-outline-primary.active,
    .btn-outline-primary:focus,
    .btn-outline-primary.focus {
    background-color: var(--primary) !important;
    border-color: var(--primary) !important;
    color: #fff !important;
    }

  
/* 圓形「?」重看教學按鈕（與 risk 風格一致） */
.tut-help{
  position:fixed; top:18px; right:18px; z-index:999;
  width:42px; height:42px; border-radius:999px; border:0;
  display:inline-flex; align-items:center; justify-content:center;
  font-weight:800; line-height:1; font-size:1rem;
  background:rgba(255,255,255,.92); color:var(--primary);
  box-shadow:0 6px 16px rgba(0,0,0,.14);
}
.tut-help:hover{ background:#fff; }
.tut-help:focus{ outline:none }
.tut-help:focus-visible{ box-shadow:0 0 0 3px rgba(4,59,143,.25), 0 6px 16px rgba(0,0,0,.14); }
/* iPhone 瀏海安全區 */
@supports(padding:env(safe-area-inset-right)){
  .tut-help{ right:calc(14px + env(safe-area-inset-right)); top:calc(14px + env(safe-area-inset-top)); }
}

  </style>
</head>
<body>
  <main class="flex-grow-1">
    <div class="container">
      <div class="card-wrapper">
        <h1>Welcome to your account!</h1>

        <div class="text-center mb-3">
          <h3 class="mb-0">Your current balance: <span class="text-primary">${{ balance }}</span></h3>
        </div>

        <h4 class="section-title">Your Stocks:</h4>
        {% if stocks %}
          <div class="stock-list mb-3">
            <ul class="mb-0">
              {% for stock in stocks %}
                <li>{{ stock['stock'] }}: {{ stock['total_quantity'] }} shares</li>
              {% endfor %}
            </ul>
          </div>
        {% else %}
          <div class="alert alert-info" role="alert">
            You have no stocks in your portfolio.
          </div>
        {% endif %}

        <h4 class="section-title">Full Portfolio Data:</h4>
        <div class="table-responsive">
          <table class="table table-hover">
            <thead>
              <tr>
                <th>Stock</th>
                <th class="text-right">Quantity</th>
                <th class="text-right">Price</th>
              </tr>
            </thead>
            <tbody>
              {% if portfolios %}
                {% for row in portfolios %}
                  <tr>
                    <td>{{ row['stock'] }}</td>
                    <td class="text-right">{{ row['quantity'] }}</td>
                    <td class="text-right">
                      {% if row['price'] %}
                        ${{ "%.2f"|format(row['price']) }}
                      {% else %}
                        N/A
                      {% endif %}
                    </td>
                  </tr>
                {% endfor %}
              {% else %}
                <tr>
                  <td colspan="3" class="text-center text-muted">No portfolio data available.</td>
                </tr>
              {% endif %}
            </tbody>
          </table>
        </div>

        <div class="actions mt-4 d-flex flex-column flex-md-row justify-content-center gap-2">
          <a href="{{ url_for('trade') }}" class="btn btn-primary mx-md-2 mb-2 mb-md-0">Go to Trading</a>
          <a href="{{ url_for('transaction') }}" class="btn btn-outline-primary mx-md-2">See Trading History</a>
          <a href="{{ url_for('main') }}" class="btn btn-outline-primary mx-md-2">Home</a>
        </div>
      </div>
    </div>
  </main>

  <!-- jQuery & Bootstrap JS -->
    <button type="button" class="tut-help" data-action="show-tutorial" aria-label="重新查看使用教學" title="使用教學">?</button>
<script src="https://code.jquery.com/jquery-3.5.1.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.5.3/dist/js/bootstrap.bundle.min.js"></script>

  <!-- 共用教學腳本 -->
  <script src="{{ url_for('static', filename='js/tutorial.js') }}"></script>

  <!-- 此頁教學：兩張圖，第一次進入該頁自動顯示（由 tutorial.js 的 localStorage 控制） -->
  <script>
    const tutAccount = initImageTutorial({
      pageKey: 'account',
      version: 'img-v1',  // 改版時改字串，使用者會再看一次
      images: [
        "{{ url_for('static', filename='image/tutorial/02_account_1.png') }}",
        "{{ url_for('static', filename='image/tutorial/02_account_2.png') }}"
      ],
      autoShow: true,
      enableEsc: true
    });
    // 若你頁面某處要手動重看，可在該元素加 data-action="show-tutorial"
    document.querySelectorAll('[data-action="show-tutorial"]').forEach(el => {
      el.addEventListener('click', e => { e.preventDefault(); tutAccount.clear(); tutAccount.show(); });
    });
  </script>
</body>
</html>
